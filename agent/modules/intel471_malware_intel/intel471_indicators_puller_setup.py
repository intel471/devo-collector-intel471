import logging
from datetime import datetime

from devocollectorsdk.inputs.collector_puller_setup_abstract import CollectorPullerSetupAbstract

log = logging.getLogger(__name__)


class Intel471IndicatorsPullerSetup(CollectorPullerSetupAbstract):

    def setup(self, execution_timestamp: datetime):
        """
        :param execution_timestamp:
        :return:
        """

        log_message = "Starting the execution of setup()"
        log.debug(log_message)

        username = self.collector_variables["username"]
        password = self.collector_variables["password"]

        self.collector_variables["access_token"] = self._get_access_token(username, password)

        log_message = "Finalizing the execution of setup()"
        log.debug(log_message)
